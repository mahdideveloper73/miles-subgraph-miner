(function(){document.addEventListener('DOMContentLoaded',function(){let $=selector=>document.querySelector(selector);let tryPromise=fn=>Promise.resolve().then(fn);let cy;let $layout=$('#layout');let maxLayoutDuration=1500;let layoutPadding=60;function exportTableToCSV(filename){var csv=[];var rows=document.querySelectorAll("table tr");for(var i=0;i<rows.length;i++){var row=[],cols=rows[i].querySelectorAll("td, th");for(var j=0;j<cols.length;j++)row.push(cols[j].innerText);csv.push(row.join(","))}
csv=csv.join("\n");var csvFile;var downloadLink;csvFile=new Blob([csv],{type:"text/csv"});downloadLink=document.createElement("a");downloadLink.download=filename;downloadLink.href=window.URL.createObjectURL(csvFile);downloadLink.style.display="none";document.body.appendChild(downloadLink);downloadLink.click()}
function export_data(){if($('#export').value=='png'){var image=cy.png({output:'blob',scale:$('#scale').value});saveAs(image,'significant_subgraphs.png')}else{var json=new Blob([JSON.stringify(cy.json())],{type:"application/json"});saveAs(json,'significant_subgraphs.json')}}
let layouts={dagre:{name:'dagre',rankDir:'TB',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,fit:!0,nodeDimensionsIncludeLabels:!0},dagrevertical:{name:'dagre',rankDir:'LR',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,fit:!0,nodeDimensionsIncludeLabels:!0},klay:{name:'klay',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,fit:!0,nodeDimensionsIncludeLabels:!0,klay:{compactComponents:!0,},},grid:{name:'dagre',condense:!1,sort:function(a,b){return a.data('pvalue')-b.data('pvalue')},animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,avoidOverlap:!0,avoidOverlapPadding:20},grid:{name:'grid',condense:!1,sort:function(a,b){return a.data('pvalue')-b.data('pvalue')},animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,avoidOverlap:!0,avoidOverlapPadding:20},circle:{name:'circle',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding},cose:{name:'cose',animate:'end',padding:layoutPadding,gravity:2,nodeOverlap:4,idealEdgeLength:function(edge){return 100},componentSpacing:25},concentric:{name:'concentric',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding},random:{name:'random',animate:!0,animationDuration:maxLayoutDuration,padding:layoutPadding,}};let prevLayout;let getLayout=name=>Promise.resolve(layouts[name]);let applyLayout=layout=>{if(prevLayout){prevLayout.stop()}
let l=prevLayout=cy.makeLayout(layout);return l.run().promiseOn('layoutstop')}
let applyLayoutFromSelect=()=>Promise.resolve($layout.value).then(getLayout).then(applyLayout);cy=window.cy=cytoscape({container:document.getElementById('cy'),elements:$INCLUDE-ELEMENTS,style:[{"selector":"core","style":{"selection-box-color":"#7ddb7d","selection-box-border-color":"#008000","selection-box-opacity":"0.5"}},{"selector":"node","style":{"width":"mapData(pvalue, -50, 0, 80, 20)","height":"mapData(pvalue, -50, 0, 80, 20)","label":"data(name)","font-size":"mapData(pvalue, -50, 0, 25px, 14px)","text-valign":"center","text-halign":"center","background-color":"mapData(pvalue, -50, 0, #555, #ccc)","border-width":"1px","border-color":"#3c3c3c","text-outline-color":"#3c3c3c","text-outline-width":"2px","color":"#fff","overlay-padding":"6px","z-index":"10"},},{"selector":"node:selected","style":{"border-width":"6px","border-color":"#AAD8FF","border-opacity":"0.4","background-color":"#77828C","text-outline-color":"#77828C"}},{"selector":"edge","style":{"curve-style":"unbundled-bezier","haystack-radius":"0","opacity":"0.4","line-color":"#bbb","width":2,"width":"mapData(pvalue, 0, -50, 1, 7)","overlay-padding":"3px","target-arrow-shape":"triangle-backcurve","target-arrow-fill":"fill",'target-arrow-color':'#bbb',"arrow-scale":3}},{"selector":"edge:selected","style":{"width":10,'line-color':"#8BB0D0",'target-arrow-color':"#8BB0D0"}},{selector:'node[type="source"]',style:{'shape':'triangle',}},{"selector":"node.unhighlighted","style":{"opacity":"1"}},{"selector":"edge.unhighlighted","style":{"opacity":"0.05"}},{"selector":".highlighted","style":{"z-index":"999999","transition-duration":"0.5s"}},{"selector":"node.highlighted","style":{"border-width":"8px","border-color":"#AAD8FF","border-opacity":"0.85","background-color":"#394855","text-outline-color":"#394855","shadow-blur":"12px","shadow-color":"#000","shadow-opacity":"0.8","shadow-offset-x":"0px","shadow-offset-y":"4px","transition-property":"border-width, border-color, border-opacity, background-color, text-outline-color, shadow-blur, shadow-color, shadow-opacity, shadow-offset-x, shadow-offset-y"}},{"selector":"node.start","style":{"border-color":"#8FDC97"}},{"selector":"node.end","style":{"border-color":"#9F4A54"}},{"selector":"edge.filtered","style":{"opacity":"0"}},{"selector":"edge.highlighted","style":{"line-color":"#AAD8FF","width":"10px"}}],layout:{name:'grid',condense:!1,sort:function(a,b){return a.data('pvalue')-b.data('pvalue')}},zoom:1,pan:{x:0,y:0},minZoom:1e-1,maxZoom:1e1,zoomingEnabled:!0,userZoomingEnabled:!0,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!0,selectionType:'single',touchTapThreshold:8,desktopTapThreshold:4,autolock:!1,autoungrabify:!1,autounselectify:!1,headless:!1,styleEnabled:!0,hideEdgesOnViewport:!1,hideLabelsOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:0.2,wheelSensitivity:.1,pixelRatio:'auto'});tryPromise(applyLayoutFromSelect);$layout.addEventListener('change',applyLayoutFromSelect);$('#redo-layout').addEventListener('click',applyLayoutFromSelect);$('#save_button').addEventListener('click',export_data);$('#save_table_button').addEventListener('click',exportTableToCSV.bind(null,'significant_subgraphs.csv'))})})()
